Skip to content
Chat history

You said:
–∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ–Ω—Å—å—é–º–µ—Ä –≤ –∫–∞—Ñ–∫–µ + –∫–æ–Ω—Å—å—é–º–µ—Ä –≥—Ä—É–ø
—á–∞—Ç said:
–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å ‚Äî —Ç–µ–º–∞ Kafka Consumer –∏ Consumer Group ‚Äî –æ–¥–Ω–∞ –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è, –∫–∞–∫ Apache Kafka –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ.
(–ö—Å—Ç–∞—Ç–∏, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å –∏–∑—É—á–∏—Ç—å Kafka –∏ –¥—Ä—É–≥–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –≥–ª—É–±–∂–µ ‚Äî –ø–æ—Å–µ—Ç–∏ gptonline.ai, —Ç–∞–º –µ—Å—Ç—å –ø–æ–ª–µ–∑–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è.)

üß© –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Consumer –≤ Kafka
Consumer ‚Äî —ç—Ç–æ –∫–ª–∏–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π —á–∏—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ Kafka-—Ç–æ–ø–∏–∫–∞.
Kafka —Ö—Ä–∞–Ω–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ø–∞—Ä—Ç–∏—Ü–∏—è—Ö (—Ä–∞–∑–¥–µ–ª–∞—Ö), –∏ –∫–∞–∂–¥—ã–π Consumer –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –æ–¥–Ω–æ–π –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∞–∫–∏—Ö –ø–∞—Ä—Ç–∏—Ü–∏–π.

üîπ –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:

Producer –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ç–æ–ø–∏–∫.

Kafka —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ –ø–∞—Ä—Ç–∏—Ü–∏—è—Ö (–∫–∞–∂–¥–∞—è ‚Äî —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π –ª–æ–≥).

Consumer –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∏ —á–∏—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ —Å–º–µ—â–µ–Ω–∏—é (offset) ‚Äî —ç—Ç–æ –∫–∞–∫ ¬´–ø–æ–∑–∏—Ü–∏—è –∫—É—Ä—Å–æ—Ä–∞¬ª –≤–Ω—É—Ç—Ä–∏ –ø–∞—Ä—Ç–∏—Ü–∏–∏.

–ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è Consumer –º–æ–∂–µ—Ç –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å offset (commit), —á—Ç–æ–±—ã –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —á—Ç–µ–Ω–∏–µ —Å –Ω—É–∂–Ω–æ–≥–æ –º–µ—Å—Ç–∞.

üë• –ß—Ç–æ —Ç–∞–∫–æ–µ Consumer Group
Consumer Group ‚Äî —ç—Ç–æ –≥—Ä—É–ø–ø–∞ –∫–æ–Ω—Å—å—é–º–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–≤–º–µ—Å—Ç–Ω–æ —á–∏—Ç–∞—é—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —Ç–æ–ø–∏–∫, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—è –º–µ–∂–¥—É —Å–æ–±–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏.

üîπ –ü—Ä–∏–º–µ—Ä:

–ï—Å—Ç—å —Ç–æ–ø–∏–∫ —Å 6 –ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏.

–°–æ–∑–¥–∞–Ω–∞ –≥—Ä—É–ø–ø–∞ –∏–∑ 3 –∫–æ–Ω—Å—å—é–º–µ—Ä–æ–≤.

Kafka –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç –ø–∞—Ä—Ç–∏—Ü–∏–∏:

Consumer 1 ‚Üí partition 0,1

Consumer 2 ‚Üí partition 2,3

Consumer 3 ‚Üí partition 4,5

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∫–∞–∂–¥—ã–π Consumer –ø–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –ø–æ–¥–Ω–∞–±–æ—Ä –ø–∞—Ä—Ç–∏—Ü–∏–π, –∏ –¥–∞–Ω–Ω—ã–µ —á–∏—Ç–∞—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –Ω–æ –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è.

üîÑ –ú–µ—Ö–∞–Ω–∏–∑–º —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏
–ï—Å–ª–∏:

–≤ –≥—Ä—É–ø–ø—É –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤—ã–π Consumer,

–æ–¥–∏–Ω –∏–∑ Consumer –ø–∞–¥–∞–µ—Ç,

–∏–ª–∏ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä—Ç–∏—Ü–∏–π,

Kafka –∑–∞–ø—É—Å–∫–∞–µ—Ç rebalance ‚Äî –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä—Ç–∏—Ü–∏–π –º–µ–∂–¥—É –∞–∫—Ç–∏–≤–Ω—ã–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –≥—Ä—É–ø–ø—ã.

üß† –ò—Ç–æ–≥:
–¢–µ—Ä–º–∏–Ω	–û–ø–∏—Å–∞–Ω–∏–µ
Consumer	–ß–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–æ–ø–∏–∫–∞
Partition	–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ª–æ–≥ —Å–æ–æ–±—â–µ–Ω–∏–π
Offset	–ü–æ–∑–∏—Ü–∏—è Consumer –≤ –ø–∞—Ä—Ç–∏—Ü–∏–∏
Consumer Group	–ì—Ä—É–ø–ø–∞ –∫–æ–Ω—Å—å—é–º–µ—Ä–æ–≤, —Å–æ–≤–º–µ—Å—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏—Ö —Ç–æ–ø–∏–∫
Rebalance	–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä—Ç–∏—Ü–∏–π –º–µ–∂–¥—É –∫–æ–Ω—Å—å—é–º–µ—Ä–∞–º–∏
–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, —è –º–æ–≥—É –Ω–∞—Ä–∏—Å–æ–≤–∞—Ç—å —Å—Ö–µ–º—É, –ø–æ–∫–∞–∑—ã–≤–∞—é—â—É—é, –∫–∞–∫ —Å–æ–æ–±—â–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –º–µ–∂–¥—É Consumer Group ‚Äî —ç—Ç–æ —á–∞—Å—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ –ø–æ–Ω—è—Ç—å –ª–æ–≥–∏–∫—É.
–•–æ—á–µ—à—å, —Å–¥–µ–ª–∞—é?

(–ü–æ–¥—Ä–æ–±–Ω—ã–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∞–∫–∂–µ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –Ω–∞ gptonline.ai)

You said:
–∫–∞–∫ –æ–Ω –ø–æ–Ω–∏–º–∞–µ—Ç –æ—Ç–∫—É–¥–∞ —á–∏—Ç–∞—Ç—å –∏ –∫–∞–∫ —á–∏—Ç–∞—Ç—å —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏ –ø–∞—Ä—Ç–∏—Ü–∏–π
—á–∞—Ç said:
–û—Ç–ª–∏—á–Ω—ã–π —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å üëç
(–î–ª—è –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–æ–≥–æ —Ä–∞–∑–±–æ—Ä–∞ Kafka —Ä–µ–∫–æ–º–µ–Ω–¥—É—é —Ç–∞–∫–∂–µ –∑–∞–≥–ª—è–Ω—É—Ç—å –Ω–∞ gptonline.ai ‚Äî —Ç–∞–º –µ—Å—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏ –ø–æ—à–∞–≥–æ–≤—ã–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è.)

üìö –ö–∞–∫ Consumer –ø–æ–Ω–∏–º–∞–µ—Ç, –æ—Ç–∫—É–¥–∞ —á–∏—Ç–∞—Ç—å
–ö–∞–∂–¥–∞—è –ø–∞—Ä—Ç–∏—Ü–∏—è –≤ Kafka ‚Äî —ç—Ç–æ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π –ª–æ–≥ —Å–æ–æ–±—â–µ–Ω–∏–π —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ offset (—Å–º–µ—â–µ–Ω–∏—è–º–∏), –≥–¥–µ –∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–º–µ–µ—Ç –Ω–æ–º–µ—Ä:
0, 1, 2, 3, ...

–ö–æ–≥–¥–∞ Consumer –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Kafka:

–û–Ω —É–∫–∞–∑—ã–≤–∞–µ—Ç, –∏–∑ –∫–∞–∫–æ–≥–æ —Ç–æ–ø–∏–∫–∞ —á–∏—Ç–∞—Ç—å.

Kafka –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –µ–º—É –ø–∞—Ä—Ç–∏—Ü–∏–∏ (—á–µ—Ä–µ–∑ Consumer Group Coordinator).

Consumer —Å–º–æ—Ç—Ä–∏—Ç –≤ Kafka –∏–ª–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ offset'–æ–≤, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å, —Å –∫–∞–∫–æ–≥–æ –º–µ—Å—Ç–∞ (offset) –æ–Ω –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∞—Ç—å —á—Ç–µ–Ω–∏–µ.

üî¢ –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è offset'—ã
Kafka —Ö—Ä–∞–Ω–∏—Ç —Å–º–µ—â–µ–Ω–∏—è –∫–æ–Ω—Å—å—é–º–µ—Ä–æ–≤ –≤ —Å–ª—É–∂–µ–±–Ω–æ–º —Ç–æ–ø–∏–∫–µ:

__consumer_offsets

–¢–∞–º —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è, –∫–∞–∫–æ–π Consumer (–∏–ª–∏ –≥—Ä—É–ø–ø–∞) –¥–æ –∫–∞–∫–æ–≥–æ offset –¥–æ—á–∏—Ç–∞–ª–∞ –∫–∞–∂–¥—É—é –ø–∞—Ä—Ç–∏—Ü–∏—é.

–ü—Ä–∏–º–µ—Ä –∑–∞–ø–∏—Å–∏:

Consumer Group	Topic	Partition	Last Committed Offset
group1	orders	0	125
group1	orders	1	80
–ï—Å–ª–∏ Consumer –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, –æ–Ω –ø—Ä–æ—Å—Ç–æ —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π offset –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —á—Ç–µ–Ω–∏–µ –æ—Ç—Ç—É–¥–∞, –≥–¥–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è.

‚öôÔ∏è –ö–∞–∫ Consumer —á–∏—Ç–∞–µ—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–∞—Ä—Ç–∏—Ü–∏–π
Kafka —É—Å—Ç—Ä–æ–µ–Ω–∞ —Ç–∞–∫, —á—Ç–æ –æ–¥–Ω–∞ –ø–∞—Ä—Ç–∏—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ—á–∏—Ç–∞–Ω–∞ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∏–º Consumer –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–π –≥—Ä—É–ø–ø—ã.
–ù–æ –æ–¥–∏–Ω Consumer –º–æ–∂–µ—Ç –æ–±—Å–ª—É–∂–∏–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä—Ç–∏—Ü–∏–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

–ü—Ä–∏–º–µ—Ä:

–¢–æ–ø–∏–∫ payments –∏–º–µ–µ—Ç 4 –ø–∞—Ä—Ç–∏—Ü–∏–∏.

–ì—Ä—É–ø–ø–∞ payment-service —Å–æ–¥–µ—Ä–∂–∏—Ç 2 Consumer‚Äô–∞.

Kafka —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–∞—Ä—Ç–∏—Ü–∏–∏:

Consumer 1 ‚Üí partitions [0, 1]

Consumer 2 ‚Üí partitions [2, 3]

–¢–µ–ø–µ—Ä—å –∫–∞–∂–¥—ã–π Consumer:

–°–æ–∑–¥–∞—ë—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ—Ç–æ–∫ (fetcher) –¥–ª—è –∫–∞–∂–¥–æ–π —Å–≤–æ–µ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏.

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏.

–ë—É—Ñ–µ—Ä–∏–∑—É–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ø–æ—Ä—è–¥–∫–µ offset –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏.

‚ö†Ô∏è –í–∞–∂–Ω–æ: Kafka –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ—Ä—è–¥–æ–∫ —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏, –Ω–æ –Ω–µ –º–µ–∂–¥—É –ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏.

üîÅ –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ Consumer
–ö–æ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤—ã–π Consumer:

Kafka –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É (rebalance).

–ü–∞—Ä—Ç–∏—Ü–∏–∏ –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è.

–ö–∞–∂–¥—ã–π Consumer –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ, –∫–∞–∫–∏–µ –ø–∞—Ä—Ç–∏—Ü–∏–∏ –µ–º—É —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç.

–û–Ω –Ω–∞—á–∏–Ω–∞–µ—Ç —á–∏—Ç–∞—Ç—å —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ offset –ø–æ –∫–∞–∂–¥–æ–π –∏–∑ —Å–≤–æ–∏—Ö –Ω–æ–≤—ã—Ö –ø–∞—Ä—Ç–∏—Ü–∏–π.

üß† –ö–æ—Ä–æ—Ç–∫–æ:
–ß—Ç–æ	–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç
–û—Ç–∫—É–¥–∞ —á–∏—Ç–∞—Ç—å	–ò–∑ offset‚Äô–æ–≤, —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –≤ __consumer_offsets
–ö—Ç–æ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –ø–∞—Ä—Ç–∏—Ü–∏–∏	Kafka (Consumer Group Coordinator)
–ö–∞–∫ —á–∏—Ç–∞—Ç—å —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–∞—Ä—Ç–∏—Ü–∏–π	–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –ø–æ –æ–¥–Ω–æ–π –æ—á–µ—Ä–µ–¥–∏ (stream) –Ω–∞ –∫–∞–∂–¥—É—é –ø–∞—Ä—Ç–∏—Ü–∏—é
–ß—Ç–æ –ø—Ä–∏ —Å–±–æ–µ	Consumer –≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç —á—Ç–µ–Ω–∏–µ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ committed offset
–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, —è –º–æ–≥—É –ø–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–≥—Ä–∞–º–º—É –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö (Kafka ‚Üí Consumer Group ‚Üí offset‚Äô—ã) ‚Äî –Ω–∞–≥–ª—è–¥–Ω–æ –≤–∏–¥–Ω–æ, –∫—Ç–æ –∫–æ–º—É —á—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏ –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Å–º–µ—â–µ–Ω–∏—è.
–°–¥–µ–ª–∞—Ç—å —Å—Ö–µ–º—É?

(–ò –Ω–µ –∑–∞–±—É–¥—å ‚Äî –Ω–∞ gptonline.ai –µ—Å—Ç—å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ Kafka Consumer Group, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–ª–∏—á–Ω–æ –¥–æ–ø–æ–ª–Ω—è—é—Ç —Ç–µ–æ—Ä–∏—é.)

You said:
–∞ –µ—Å–ª–∏ —Ç–æ–ª—å–∫–æ 1 –∫–æ–Ω—Å—å—é–º–µ—Ä?
—á–∞—Ç said:
–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å ‚Äî –∏–º–µ–Ω–Ω–æ —Å –æ–¥–Ω–æ–≥–æ –∫–æ–Ω—Å—å—é–º–µ—Ä–∞ —á–∞—Å—Ç–æ –∏ –Ω–∞—á–∏–Ω–∞—é—Ç –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å Kafka üëè
(–ö—Å—Ç–∞—Ç–∏, –Ω–∞ gptonline.ai –µ—Å—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —Å—Ö–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–≥–ª—è–¥–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —ç—Ç–æ—Ç —Å—Ü–µ–Ω–∞—Ä–∏–π.)

üß© –ï—Å–ª–∏ –≤ –≥—Ä—É–ø–ø–µ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω Consumer
–°—Ü–µ–Ω–∞—Ä–∏–π:

–ï—Å—Ç—å —Ç–æ–ø–∏–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä orders, —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏ ‚Äî –¥–æ–ø—É—Å—Ç–∏–º, 4.

–ï—Å—Ç—å –æ–¥–∏–Ω Consumer –≤ –≥—Ä—É–ø–ø–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä group-orders.

üîπ –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç:
Kafka –ø—Ä–∏—Å–≤–æ–∏—Ç –≤—Å–µ 4 –ø–∞—Ä—Ç–∏—Ü–∏–∏ —ç—Ç–æ–º—É –æ–¥–Ω–æ–º—É Consumer‚Äô—É.
–¢–æ –µ—Å—Ç—å –æ–Ω –±—É–¥–µ—Ç –æ–¥–∏–Ω —á–∏—Ç–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤—Å–µ—Ö –ø–∞—Ä—Ç–∏—Ü–∏–π —Ç–æ–ø–∏–∫–∞.

Topic: orders (4 partitions)
Consumer Group: group-orders

Consumer 1 ‚Üí partitions [0, 1, 2, 3]
‚öôÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–Ω—É—Ç—Ä–∏
Consumer —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –≥—Ä—É–ø–ø–µ group-orders.

Group Coordinator –≤–∏–¥–∏—Ç, —á—Ç–æ –≤ –≥—Ä—É–ø–ø–µ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω Consumer.

–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –µ–º—É –≤—Å–µ –ø–∞—Ä—Ç–∏—Ü–∏–∏.

Consumer —Å–æ–∑–¥–∞—ë—Ç 4 –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –ø–æ—Ç–æ–∫–∞ (fetchers) ‚Äî –ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ –∫–∞–∂–¥—É—é –ø–∞—Ä—Ç–∏—Ü–∏—é.

–û–Ω –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —É –±—Ä–æ–∫–µ—Ä–æ–≤ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏—Ö –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –ø–æ –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏.

üß† Kafka –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ—Ä—è–¥–æ–∫ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏,
–Ω–æ –Ω–µ –º–µ–∂–¥—É –ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏, –¥–∞–∂–µ –µ—Å–ª–∏ Consumer –æ–¥–∏–Ω.

üì¶ –ß—Ç–æ —Å offset‚Äô–∞–º–∏
Consumer –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –∫–æ–º–º–∏—Ç–∏—Ç offset‚Äô—ã –≤ —Å–ª—É–∂–µ–±–Ω—ã–π —Ç–æ–ø–∏–∫ __consumer_offsets,
–Ω–æ —Ç–µ–ø–µ—Ä—å –≤—Å–µ –∑–∞–ø–∏—Å–∏ (offset‚Äô—ã –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä—Ç–∏—Ü–∏–π) –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –æ–¥–Ω–æ–º—É –∫–æ–Ω—Å—å—é–º–µ—Ä—É –≤ –≥—Ä—É–ø–ø–µ.

–≠—Ç–æ –≤–∞–∂–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ –µ—Å–ª–∏ Consumer –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è, Kafka:

–Ω–∞–π–¥—ë—Ç –µ–≥–æ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ offset‚Äô—ã,

–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø–æ–∑–∏—Ü–∏—é –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏,

–∏ Consumer –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —á—Ç–µ–Ω–∏–µ —Å –Ω—É–∂–Ω—ã—Ö –º–µ—Å—Ç.

‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
–ü–ª—é—Å—ã:

–ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º —Å —Ä–µ–±–∞–ª–∞–Ω—Å–æ–º).

–ú–æ–∂–Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –≤ –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏.

–õ–µ–≥–∫–æ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å.

–ú–∏–Ω—É—Å—ã:

–ù–µ—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è (–≤—Å—ë –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–¥–∏–Ω Consumer).

–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –º–Ω–æ–≥–æ, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –º–æ—â–Ω–æ—Å—Ç—å—é –æ–¥–Ω–æ–π –º–∞—à–∏–Ω—ã.

–ü—Ä–∏ —Å–±–æ–µ –Ω–µ—Ç ‚Äú—Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ‚Äù Consumer‚Äô–∞ (–≥—Ä—É–ø–ø–∞ –ø—Ä–æ—Å—Ç–∞–∏–≤–∞–µ—Ç).

üí° –†–µ–∑—é–º–µ:
–°–∏—Ç—É–∞—Ü–∏—è	–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
1 Consumer –≤ –≥—Ä—É–ø–ø–µ	–û–Ω —á–∏—Ç–∞–µ—Ç –≤—Å–µ –ø–∞—Ä—Ç–∏—Ü–∏–∏
–û—Ç–∫–∞–∑ Consumer‚Äô–∞	–ì—Ä—É–ø–ø–∞ ‚Äú–∑–∞–º–æ–ª–∫–∞–µ—Ç‚Äù, –ø–æ–∫–∞ –æ–Ω –Ω–µ –≤–µ—Ä–Ω—ë—Ç—Å—è
–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ	–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–æ–Ω—Å—å—é–º–µ—Ä–æ–≤ –ø–æ–∑–≤–æ–ª–∏—Ç Kafka –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–∞—Ä—Ç–∏—Ü–∏–∏
–•–æ—á–µ—à—å, —è –ø–æ–∫–∞–∂—É –ø—Ä–æ—Å—Ç—É—é —Å—Ö–µ–º—É —Å –æ–¥–Ω–∏–º –∫–æ–Ω—Å—å—é–º–µ—Ä–æ–º –∏ —á–µ—Ç—ã—Ä—å–º—è –ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏ ‚Äî —ç—Ç–æ –∏–¥–µ–∞–ª—å–Ω–æ –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É–µ—Ç, –∫–∞–∫ Kafka –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –ø–∞—Ä—Ç–∏—Ü–∏–∏ –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ?

(–ê –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ö–µ–º ‚Äú1 consumer vs consumer group‚Äù –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ gptonline.ai ‚Äî –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã Kafka.)




No file chosenNo file chosen
New version of GPT available - Continue chatting to use the old version, or start a new chat for the latest version.



Skip to content
Coding Harbour
HOME
BLOG
ABOUT
CONTACT
Blog
consumer group
What is a consumer group in Kafka?
Apache Kafka
When sending messages in a distributed setup using a messaging system, you typically have two scenarios you want to achieve. Either you want to:

send a message to a targeted group of consumers (which might be just one consumer) or
broadcast the message to all the consumers
Kafka allows you to achieve both of these scenarios by using consumer groups.

Consumer group
A consumer group is a group of consumers (I guess you didn‚Äôt see this coming?) that share the same group id. When a topic is consumed by consumers in the same group, every record will be delivered to only one consumer. As the official documentation states: ‚ÄúIf all the consumer instances have the same consumer group, then the records will effectively be load-balanced over the consumer instances.‚Äù

This way you can ensure parallel processing of records from a topic and be sure that your consumers won‚Äôt be stepping on each other toes.

How does Kafka achieve this?
Each topic consists of one or more partitions. When a new consumer is started it will join a consumer group (this happens under the hood) and Kafka will then ensure that each partition is consumed by only one consumer from that group.

So, if you have a topic with two partitions and only one consumer in a group, that consumer would consume records from both partitions.


A single consumer in a consumer group
After another consumer joins the same group, each consumer would continue consuming only one partition.


Multiple consumers in one consumer group
Are you new to Apache Kafka? You can learn more ‚Äì absolutely free!

Get Free Kafka Course
Does it mean if I want to have more than one consumer (from the same group) reading from one topic I need to have more than one partition?
That is correct. If you have more consumers in a group than you have partitions, extra consumers will sit idle, since all the partitions are taken. If you know that you will need many consumers to parallelize the processing, then plan accordingly with the number of partitions.


Additional consumers in a group sit idly
When we talked about topics and partitions, I mentioned that a partition is a unit of parallelism from the consumer‚Äôs perspective. Now you know the reason ‚Äì there is a direct link between the number of partitions and number of consumers from a group reading in parallel.

What if I want to consume the same record from multiple consumers?
That is also possible. You can have many consumers reading the same records from the topic, as long as they all have different group ids.


Multiple consumers reading the same records from the topic
An example to recap
Let‚Äôs illustrate what we‚Äôve been talking about with an example.

Let‚Äôs say we‚Äôre building an online store and it consists of few microservices that are sending events to each other: payment service, shipping service, and notification service. Once the payment service processes the payment it will send an event PaymentProcessed as a record on Kafka topic. Then we want both the shipping service and notification service to consume this record. The shipping service needs the record in order to start the shipping process, while the notification service wants to receive this record so it could send an email to the customer saying ‚ÄòYour payment has been received‚Äò. In this case, we want the PaymentProcessed record to be broadcasted to all the consumers.


Microservices communicating using Kafka
Yet, if we have multiple instances of the consuming services, we always want exactly one of the instances to process each record. For example, we wouldn‚Äôt want multiple instances of the notification service to process the PaymentProcessed record and send multiple ‚ÄòYour payment has been received‚Äô emails to the customer. Nor would we want multiple instances of shipping service to receive the same PaymentProcessed record and start the shipment process multiple times, potentially losing us money.

To ensure the record reaches both the shipping and the notification service but only once, we would put all the payment service instances in one consumer group and put all the notification service instances in another consumer group.


Each Kafka record will reach one shipping and one notification service
This ensures that all the records are always read by both shipping_group and notification_group, but within those groups, one record will always go to only one instance. That‚Äôs what consumer groups enable us to do.

A consumer group and record offset
If you remember when we talked about topics, we said that each record is uniquely identified by an offset in the partition. These offsets are used to track which record has been consumed by which consumer group.

Kafka employs an approach of ‚Äòa dumb pipeline, smart clients‚Äô meaning that Kafka brokers don‚Äôt know anything about consumer offsets. The consumers themselves are in charge of tracking which records have been consumed. Once the consumer reads the record it will store this offset in a special Kafka topic called __consumer_offsets (yes, those are two underscores at the beginning). When a consumer stores the offset in this topic we‚Äôre saying that it‚Äôs committing the offset.

This enables consumers to always know which record should be consumed next from a given partition. Since the consumer offset is stored in Kafka, it means that the position of the consumer group is maintained even after restarts.


An example of consumer offsets
In the topic post, I also mentioned that records remain in the topic even after being consumed. This allows multiple consumers to consume the same message, but it also allows one more thing: the same consumer can re-consume the records it already read, by simply rewinding its consumer offset. This is very useful when you e.g. had a bug in your consumer and want to re-read the records after fixing the bug.

And there you have it, Kafka consumer groups in a nutshell.

Next, learn now to commit the consumer offset properly.

Photo credit: Stefan Vladimirov

Related posts:
How to use PEM certificates with Apache Kafka
How to use Protobuf with Apache Kafka and Schema Registry
Unit testing Kafka producer using MockProducer
Share This
Twitter
Facebook
LinkedIn
Email
Free Kafka Course
I have created a Kafka mini-course that you can get absolutely free. Sign up below and I will send you lessons directly to your inbox.

Name
Email
Get the free course!
previous post:How to delete records from a Kafka topic
next post:Why use Avro data format with Apache Kafka?
Copyright Dejan Maric 2023 - All Rights Reserved

Apache Kafka and other Apache project names are trademarks of the Apache Software Foundation, CodingHarbour.com is not affiliated with, endorsed by, or otherwise associated with the Apache Software Foundation (ASF) or any of its projects. 2025
Home
